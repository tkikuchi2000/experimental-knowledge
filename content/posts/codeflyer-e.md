---
title: "Codeflyer E"
date: 2018-06-03T08:59:45+09:00
draft: true
description: "B - 洋菓子店"
featured_image: "/images/logo_account_h.png"
tags: [AtCoder]
toc: true
---

[codeflyer](https://bitflyer2018-qual.contest.atcoder.jp/)

# E - 祝日

時間制限 : 5sec / メモリ制限 : 256MB

配点 : 700 点

## 問題文

AtCoder 国の 1 年は Y 週間からなり、1 週間は W 日間からなります。 すなわち、1 年は Y×W 日間からなります。 また、曜日には順に 1,2,…,W の番号がついています。 すなわち、各 i (1≤i<W) に対して曜日 i の日の翌日は曜日 i+1 で、 曜日 W の日の翌日は曜日 1 です。

AtCoder 国の祝日は以下のように定められています。

- 各 i (1≤i≤N) に対して、一年のうち Ai 日目は祝日である。
- 各 j (1≤j≤M) に対して、一年のうち Bj 回目の曜日 Cj の日は祝日である。
- 一年のうち x 日目および y 日目が祝日であり、1≤y−x−1≤D が成り立つとき、 一年のうち x+1,x+2,…,y−1 日目はすべて祝日である。
- 上記で祝日とならなかった日はすべて祝日ではない。

AtCoder 国の一年の最初の日が曜日 d であった場合の一年間の祝日の日数を各 d=1,2,…,W に対して求めてください。

## 制約

- 1≤Y≤109
- 1≤W≤105
- 0≤N≤50
- 0≤M≤105
- 0≤D≤Y×W
- 1≤Ai≤Y×W (1≤i≤N)
- i≠j のとき、Ai≠Aj
- 1≤Bi≤Y (1≤i≤M)
- 1≤Ci≤W (1≤i≤M)
- i≠j のとき、Bi≠Bj または Ci≠Cj

## 部分点

- N=0 を満たすデータセットに正答すると、600 点が与えられる。

## 入力

入力は以下の形式で標準入力から与えられる。

```
Y W
N M D
A1
A2
:
AN
B1 C1
B2 C2
:
BM CM
```

## 出力

W 行出力せよ。i 行目 (1≤i≤W) には、d=i のときの答えを出力せよ。

---

## 入力例 1

```
3 4
0 3 1
1 2
2 4
3 3
```

## 出力例 1

```
3
3
4
4
```

たとえば、一年の最初の日の曜日が 3 であった場合、一年の 4,5,6,9 日目が祝日となります。

---

## 入力例 2

```
100 5
0 2 496
100 5
1 1
```

## 出力例 2

```
2
495
495
495
495
```

## 入力例 3

```
52 7
12 4 1
1
42
80
119
123
124
125
126
266
307
327
357
2 2
29 2
38 2
41 2
```

## 出力例 3

```
16
16
15
16
17
16
16
```

## 入力例 4

```
3 10
2 5 1
29
9
2 6
1 9
3 9
3 7
2 8
```

## 出力例 4

```
7
9
11
9
9
10
8
8
7
8
```
